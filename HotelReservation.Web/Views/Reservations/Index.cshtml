@model IEnumerable<HotelReservation.Core.DTOs.ReservationListDto>
@using HotelReservation.Core.Enums
@inject IStringLocalizer<HotelReservation.Web.SharedResource> Localizer
@{
    ViewData["Title"] = Localizer["AllReservations"];
}

<div class="page-header text-center mb-5">
    <h1 class="display-5 mb-3"><i class="fas fa-calendar-alt me-3 text-accent"></i>@Localizer["AllReservations"]</h1>
    <p class="lead text-muted">@Localizer["ManageAllBookings"]</p>
</div>

<div class="d-flex justify-content-end mb-4">
    <a asp-controller="Export" asp-action="ReservationsCsv" class="btn btn-hero">
        <i class="fas fa-file-csv me-2"></i>@Localizer["ExportCSV"]
    </a>
</div>

@if (Model.Any())
{
    <div class="detail-card">
        <div class="detail-card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>@Localizer["ID"]</th>
                            <th>@Localizer["Guest"]</th>
                            <th>@Localizer["Hotel"]</th>
                            <th>@Localizer["Room"]</th>
                            <th>@Localizer["CheckIn"]</th>
                            <th>@Localizer["CheckOut"]</th>
                            <th>@Localizer["Guests"]</th>
                            <th>@Localizer["Total"]</th>
                            <th>@Localizer["Status"]</th>
                            <th>@Localizer["Actions"]</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var reservation in Model.OrderByDescending(r => r.CreatedAt))
                        {
                            <tr>
                                <td><strong>#@reservation.Id</strong></td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="feature-icon me-2" style="width: 35px; height: 35px; font-size: 0.75rem;">
                                            <i class="fas fa-user"></i>
                                        </div>
                                        <span>@reservation.UserName</span>
                                    </div>
                                </td>
                                <td>@reservation.HotelName</td>
                                <td><span class="badge bg-dark">@reservation.RoomNumber</span></td>
                                <td>@reservation.CheckInDate.ToString("MMM dd, yyyy")</td>
                                <td>@reservation.CheckOutDate.ToString("MMM dd, yyyy")</td>
                                <td>
                                    <span class="badge bg-info text-dark">
                                        <i class="fas fa-users me-1"></i>@reservation.NumberOfGuests
                                    </span>
                                </td>
                                <td><span class="text-accent fw-bold">$@reservation.TotalPrice</span></td>
                                <td>
                                    <span class="status-badge 
                                        @(reservation.Status == ReservationStatus.Confirmed ? "status-confirmed" : 
                                          reservation.Status == ReservationStatus.Cancelled ? "status-cancelled" : 
                                          "status-pending")">
                                        @Localizer[reservation.StatusName]
                                    </span>
                                </td>
                                <td>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <a asp-action="Details" asp-route-id="@reservation.Id" 
                                           class="btn btn-outline-primary" title="@Localizer["ViewDetails"]">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        @if (reservation.Status == ReservationStatus.Confirmed && reservation.CheckInDate > DateTime.Now)
                                        {
                                            <form asp-action="Cancel" asp-route-id="@reservation.Id" method="post" 
                                                  onsubmit="return confirm('@Localizer["CancelConfirmation"]');"
                                                  style="display:inline;">
                                                <button type="submit" class="btn btn-outline-danger btn-sm" title="@Localizer["Cancel"]">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </form>
                                        }
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}
else
{
    <div class="text-center py-5">
        <div class="feature-icon mx-auto mb-4" style="width: 100px; height: 100px;">
            <i class="fas fa-calendar-alt fa-3x"></i>
        </div>
        <h3 class="text-muted mb-3">@Localizer["NoReservationsFound"]</h3>
        <p class="text-muted">@Localizer["ReservationsWillAppearHere"]</p>
    </div>
}
